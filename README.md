# p1-img-hwan17

# **Task Description**

**Overview**

COVID-19의 확산으로 우리나라는 물론 전 세계 사람들은 경제적, 생산적인 활동에 많은 제약을 가지게 되었습니다. 우리나라는 COVID-19 확산 방지를 위해 사회적 거리 두기를 단계적으로 시행하는 등의 많은 노력을 하고 있습니다. 과거 높은 사망률을 가진 사스(SARS)나 에볼라(Ebola)와는 달리 COVID-19의 치사율은 오히려 비교적 낮은 편에 속합니다. 그럼에도 불구하고, 이렇게 오랜 기간 동안 우리를 괴롭히고 있는 근본적인 이유는 바로 COVID-19의 강력한 전염력 때문입니다.

감염자의 입, 호흡기로부터 나오는 비말, 침 등으로 인해 다른 사람에게 쉽게 전파가 될 수 있기 때문에 감염 확산 방지를 위해 무엇보다 중요한 것은 모든 사람이 마스크로 코와 입을 가려서 혹시 모를 감염자로부터의 전파 경로를 원천 차단하는 것입니다. 이를 위해 공공 장소에 있는 사람들은 반드시 마스크를 착용해야 할 필요가 있으며, 무엇 보다도 코와 입을 완전히 가릴 수 있도록 올바르게 착용하는 것이 중요합니다. 하지만 넓은 공공장소에서 모든 사람들의 올바른 마스크 착용 상태를 검사하기 위해서는 추가적인 인적자원이 필요할 것입니다.

따라서, 우리는 카메라로 비춰진 사람 얼굴 이미지 만으로 이 사람이 마스크를 쓰고 있는지, 쓰지 않았는지, 정확히 쓴 것이 맞는지 자동으로 가려낼 수 있는 시스템이 필요합니다. 이 시스템이 공공장소 입구에 갖춰져 있다면 적은 인적자원으로도 충분히 검사가 가능할 것입니다.

---


## 본인의 점수 및 순위

-   LB 점수: 0.7372 (73등)

## 검증(Validation) 전략

-   제공된 train 데이터셋을 5-fold와 random_split 방식을 동시에 적용하여 사용.

## 사용한 모델 아키텍쳐 및 하이퍼 파라미터

-   모델 아키텍쳐: efficientnet_b3_pruned (gender&age / mask classifier)
-   LB 점수: 0.7521 (public LB)
-   Augmentation: CenterCrop(), HorizontalFlip(), RandomBrightnessContrast(), Normalize()
-   Img_size: 500 x 300 (초기 값, 중간에 CenterCrop을 통해 크게 입력)
-   Optimizer: AdamP
-   Loss: FocalLoss

## 추가 시도

-   처음에는 mask, age, gender 3개의 모델로 분리하여 시도한 후, age와 gender를 한 모델로 통합.
-   Focal loss와 F1 loss를 결합하여 사용 시도, 효과 없음.
-   완전 연결계층에 dropout과 relu를 추가한 실험 진행, 초기에는 효과 있었으나 에폭 증가 시 성능 하락.
-   AdamP 옵티마이저 적용 시 성능 향상.
-   데이터 불균형 문제로 인한 업샘플링 시도, 후에 제거.
-   나이 기준 수정하여 성능 개선 시도.
-   데이터를 사람별로 분할하여 mask 모델 학습, age&gender는 나이별로 섞어서 학습.
-   Pretrained 모델에서 classifier만 학습하여 사용 시도, 성능 하락.
-   최종 앙상블 시도, 단순 평균 방법 사용.

## 학습과정에서의 교훈

-   EDA 시각화를 통해 데이터를 다양한 관점에서 분석할 필요성.
-   간단한 모델을 사용하여 augmentation 효과 빠르게 확인.
-   데이터의 균형 문제에 대한 다양한 해결 방법 고민.
-   LR 스케줄링과 하이퍼 파라미터 조절 중요성.
-   코드 작업 환경에 대한 습관 형성 (VSCode 사용 등).
-   모델과 하이퍼 파라미터 선택 이유에 대한 이해.
-   TensorBoard 등의 도구 활용 미흡.

## 마주한 한계와 도전숙제

-   EDA 다양성 부족 보완.
-   LR 스케줄링과 하이퍼 파라미터 조절 이해와 적용.
-   코드 작업 환경 습관화 (VSCode 등).
-   모델 아키텍처에 대한 이해와 선택 이유.
-   데이터 불균형 해결 방법 탐구.
-   자동 하이퍼 파라미터 튜닝 도구 활용.
-   앙상블 방법 다양성 추가.
-   TensorBoard 등 다양한 도구에 대한 이해와 활용.